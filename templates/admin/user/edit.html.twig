{% extends 'admin/admin_base.html.twig' %}

{% block title %}Edit User - CORK Admin{% endblock %}

{% block admin_content %}
<div class="min-h-screen bg-[#4B164C] py-2 px-0">
    <div class="min-h-screen bg-[#4B164C]">
        <div class="fixed top-0 left-64 right-0 bottom-0 z-50 flex items-center justify-center modal-overlay">
            <div class="w-full px-6 sm:px-8 lg:px-16 xl:px-24 2xl:px-32 bg-white/95 backdrop-blur-lg py-10 rounded-3xl shadow-2xl border border-[#EFCFB4] relative overflow-hidden max-h-screen overflow-y-auto">

                <!-- Top Accent Line -->
                <div class="absolute top-0 left-0 right-0 h-2 bg-gradient-to-r from-[#EFCFB4] via-[#9E2B47] to-[#7F1734] rounded-t-3xl"></div>

                <!-- Header -->
                <h1 class="text-4xl font-extrabold text-center text-[#7F1734] tracking-tight mb-2">
                    ‚úèÔ∏è Edit User
                </h1>
                <div class="text-center text-gray-600 text-sm mb-8 space-y-1">
                    <p><strong>ID:</strong> #{{ user.id }}</p>
                    <p><strong>Email:</strong> {{ user.email }}</p>
                </div>

                {{ form_start(form, {
                    'attr': {'class': 'space-y-6', 'novalidate': 'novalidate'}
                }) }}

                <!-- Email -->
                <div>
                    {{ form_label(form.email, 'Email Address', {
                        'label_attr': {'class': 'block text-sm font-semibold text-[#4B164C] mb-2 tracking-wide'}
                    }) }}
                    {{ form_widget(form.email, {
                        'attr': {
                            'class': 'w-full px-5 py-4 rounded-2xl bg-white border border-amber-200 shadow focus:ring-4 focus:ring-[#9E2B47]/40 focus:border-[#7F1734] text-gray-800 placeholder-gray-400 transition-all duration-300',
                            'placeholder': 'user@example.com',
                            'required': 'required'
                        }
                    }) }}
                    {% if form_errors(form.email) %}
                        <div class="text-sm text-red-600 mt-1">
                            {% for error in form_errors(form.email) %}
                                <p>{{ error.message }}</p>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>

                <!-- Role Selection -->
                <div>
                    {{ form_label(form.roles, 'Select User Role', {
                        'label_attr': {'class': 'block text-sm font-semibold text-[#4B164C] mb-2 tracking-wide'}
                    }) }}
                    {{ form_widget(form.roles, {
                        'attr': {
                            'class': 'w-full px-5 py-4 rounded-2xl bg-white border border-amber-200 shadow focus:ring-4 focus:ring-[#9E2B47]/40 focus:border-[#7F1734] text-gray-800 transition-all duration-300'
                        }
                    }) }}
                    {% if form_errors(form.roles) %}
                        <p class="text-sm text-red-600 mt-1">{{ form_errors(form.roles) }}</p>
                    {% endif %}
                    <p class="text-xs text-gray-600 mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                        <strong>Roles Explanation:</strong><br>
                        üîê <strong>Administrator:</strong> Full access to admin panel<br>
                        üë®‚Äçüíº <strong>Staff Member:</strong> Can manage products and orders<br>
                        üë§ <strong>Customer:</strong> Standard customer account
                    </p>
                </div>

                <!-- Password Section -->
                <div class="bg-blue-50 border border-blue-200 rounded-xl p-4">
                    <p class="text-xs text-blue-700 mb-4">üí° Leave password fields empty to keep the current password unchanged</p>
                    
                    <!-- Password -->
                    <div>
                        {{ form_label(form.plainPassword.first, 'New Password (Optional)', {
                            'label_attr': {'class': 'block text-sm font-semibold text-[#4B164C] mb-2 tracking-wide'}
                        }) }}
                        {{ form_widget(form.plainPassword.first, {
                            'attr': {
                                'class': 'w-full px-5 py-4 rounded-2xl bg-white border border-amber-200 shadow focus:ring-4 focus:ring-[#9E2B47]/40 focus:border-[#7F1734] text-gray-800 placeholder-gray-400 transition-all duration-300',
                                'placeholder': 'Minimum 6 characters'
                            }
                        }) }}
                        {% if form_errors(form.plainPassword.first) %}
                            <div class="text-sm text-red-600 mt-1">
                                {% for error in form_errors(form.plainPassword.first) %}
                                    <p>{{ error.message }}</p>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>

                    <!-- Confirm Password -->
                    <div class="mt-4">
                        {{ form_label(form.plainPassword.second, 'Confirm Password (Optional)', {
                            'label_attr': {'class': 'block text-sm font-semibold text-[#4B164C] mb-2 tracking-wide'}
                        }) }}
                        {{ form_widget(form.plainPassword.second, {
                            'attr': {
                                'class': 'w-full px-5 py-4 rounded-2xl bg-white border border-amber-200 shadow focus:ring-4 focus:ring-[#9E2B47]/40 focus:border-[#7F1734] text-gray-800 placeholder-gray-400 transition-all duration-300',
                                'placeholder': 'Re-enter password'
                            }
                        }) }}
                        {% if form_errors(form.plainPassword.second) %}
                            <div class="text-sm text-red-600 mt-1">
                                {% for error in form_errors(form.plainPassword.second) %}
                                    <p>{{ error.message }}</p>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Metadata -->
                <div class="bg-gray-50 border border-gray-200 rounded-xl p-4 text-xs text-gray-600 space-y-1">
                    <p><strong>Created:</strong> {{ user.createdAt ? user.createdAt|date('M d, Y H:i') : 'N/A' }}</p>
                    {% if user.updatedAt %}
                        <p><strong>Last Updated:</strong> {{ user.updatedAt|date('M d, Y H:i') }}</p>
                    {% endif %}
                </div>

                <!-- Buttons -->
                <div class="flex gap-4 justify-center pt-6 border-t border-gray-200">
                    <a href="{{ path('admin_users_index') }}"
                        class="px-6 py-3 rounded-xl font-semibold text-[#4B164C] border border-[#EFCFB4] bg-white hover:bg-gray-100 transition-all duration-300">
                        ‚úï Cancel
                    </a>
                    <button type="submit" class="px-8 py-3 rounded-xl font-semibold text-white bg-gradient-to-r from-[#7F1734] to-[#9E2B47] hover:from-[#5E0B15] hover:to-[#7F1734] shadow-lg transition-all duration-300">
                        ‚úì Update User
                    </button>
                </div>

                {{ form_end(form) }}
            </div>
        </div>
    </div>
</div>

{% endblock %}
