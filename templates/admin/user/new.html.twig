{% extends 'admin/admin_base.html.twig' %}

{% block title %}Create New User - CORK Admin{% endblock %}

{% block admin_content %}
<div class="min-h-screen bg-[#4B164C] py-2 px-0">
    <div class="min-h-screen bg-[#4B164C]">
        <div class="fixed top-0 left-64 right-0 bottom-0 z-50 flex items-center justify-center modal-overlay">
            <div class="w-11/12 max-w-6xl bg-white/95 backdrop-blur-lg py-10 px-8 rounded-3xl shadow-2xl border border-[#EFCFB4] relative overflow-hidden max-h-screen overflow-y-auto">

                <!-- Top Accent Line -->
                <div class="absolute top-0 left-0 right-0 h-2 bg-gradient-to-r from-[#EFCFB4] via-[#9E2B47] to-[#7F1734] rounded-t-3xl"></div>

                <!-- Header -->
                <h1 class="text-4xl font-extrabold text-center text-[#7F1734] tracking-tight mb-2">
                    ‚ûï Create New User
                </h1>
                <p class="text-center text-gray-600 text-sm mb-8">Add a new user to the system with the selected role</p>

                {% if form.vars.errors|length > 0 %}
                    <div class="mb-6 p-4 bg-red-50 border-l-4 border-red-600 rounded-lg">
                        <p class="text-sm font-semibold text-red-800 mb-2">Form Errors:</p>
                        {% for error in form.vars.errors %}
                            <p class="text-sm text-red-700">- {{ error.message }}</p>
                        {% endfor %}
                    </div>
                {% endif %}

                {{ form_start(form, {
                    'attr': {'class': 'space-y-6', 'novalidate': 'novalidate'}
                }) }}

                <!-- Username -->
                <div>
                    {{ form_label(form.username, 'Username', {
                        'label_attr': {'class': 'block text-sm font-semibold text-[#4B164C] mb-2 tracking-wide'}
                    }) }}
                    {{ form_widget(form.username, {
                        'attr': {
                            'class': 'w-full px-5 py-4 rounded-2xl bg-white border border-amber-200 shadow focus:ring-4 focus:ring-[#9E2B47]/40 focus:border-[#7F1734] text-gray-800 placeholder-gray-400 transition-all duration-300',
                            'placeholder': 'username',
                            'required': 'required'
                        }
                    }) }}
                    {% if form_errors(form.username) %}
                        <div class="text-sm text-red-600 mt-1">
                            {% for error in form_errors(form.username) %}
                                <p>{{ error.message }}</p>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>

                <!-- Email and Role Row -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Email -->
                    <div>
                        {{ form_label(form.email, 'Email Address', {
                            'label_attr': {'class': 'block text-sm font-semibold text-[#4B164C] mb-2 tracking-wide'}
                        }) }}
                        {{ form_widget(form.email, {
                            'attr': {
                                'class': 'w-full px-5 py-4 rounded-2xl bg-white border border-amber-200 shadow focus:ring-4 focus:ring-[#9E2B47]/40 focus:border-[#7F1734] text-gray-800 placeholder-gray-400 transition-all duration-300',
                                'placeholder': 'user@example.com',
                                'required': 'required'
                            }
                        }) }}
                        {% if form_errors(form.email) %}
                            <div class="text-sm text-red-600 mt-1">
                                {% for error in form_errors(form.email) %}
                                    <p>{{ error.message }}</p>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>

                    <!-- Role Selection -->
                    <div>
                        {{ form_label(form.roles, 'Select User Role', {
                            'label_attr': {'class': 'block text-sm font-semibold text-[#4B164C] mb-2 tracking-wide'}
                        }) }}
                        {{ form_widget(form.roles, {
                            'attr': {
                                'class': 'w-full px-5 py-4 rounded-2xl bg-white border border-amber-200 shadow focus:ring-4 focus:ring-[#9E2B47]/40 focus:border-[#7F1734] text-gray-800 transition-all duration-300'
                            }
                        }) }}
                        {% if form_errors(form.roles) %}
                            <p class="text-sm text-red-600 mt-1">{{ form_errors(form.roles) }}</p>
                        {% endif %}
                    </div>
                </div>

                <!-- Roles Explanation -->
                <p class="text-xs text-gray-600 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                    <strong>Roles Explanation:</strong><br>
                    üîê <strong>Administrator:</strong> Full access to admin panel<br>
                    üë®‚Äçüíº <strong>Staff Member:</strong> Can manage products and orders<br>
                    üë§ <strong>Customer:</strong> Standard customer account
                </p>

                <!-- Password and Confirm Password Row -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Password -->
                    <div>
                        {{ form_label(form.plainPassword.first, 'Password', {
                            'label_attr': {'class': 'block text-sm font-semibold text-[#4B164C] mb-2 tracking-wide'}
                        }) }}
                        {{ form_widget(form.plainPassword.first, {
                            'attr': {
                                'class': 'w-full px-5 py-4 rounded-2xl bg-white border border-amber-200 shadow focus:ring-4 focus:ring-[#9E2B47]/40 focus:border-[#7F1734] text-gray-800 placeholder-gray-400 transition-all duration-300',
                                'placeholder': 'Minimum 6 characters',
                                'required': 'required'
                            }
                        }) }}
                        {% if form_errors(form.plainPassword) %}
                            <div class="text-sm text-red-600 mt-2">
                                {% for error in form_errors(form.plainPassword) %}
                                    <p>‚ö†Ô∏è {{ error.message }}</p>
                                {% endfor %}
                            </div>
                        {% endif %}
                        {% if form_errors(form.plainPassword.first) %}
                            <div class="text-sm text-red-600 mt-2">
                                {% for error in form_errors(form.plainPassword.first) %}
                                    <p>‚ö†Ô∏è {{ error.message }}</p>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>

                    <!-- Confirm Password -->
                    <div>
                        {{ form_label(form.plainPassword.second, 'Confirm Password', {
                            'label_attr': {'class': 'block text-sm font-semibold text-[#4B164C] mb-2 tracking-wide'}
                        }) }}
                        {{ form_widget(form.plainPassword.second, {
                            'attr': {
                                'class': 'w-full px-5 py-4 rounded-2xl bg-white border border-amber-200 shadow focus:ring-4 focus:ring-[#9E2B47]/40 focus:border-[#7F1734] text-gray-800 placeholder-gray-400 transition-all duration-300',
                                'placeholder': 'Re-enter password',
                                'required': 'required'
                            }
                        }) }}
                        {% if form_errors(form.plainPassword.second) %}
                            <div class="text-sm text-red-600 mt-2">
                                {% for error in form_errors(form.plainPassword.second) %}
                                    <p>‚ö†Ô∏è {{ error.message }}</p>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                </div>

                <!-- CSRF Token (Hidden) -->
                {{ form_widget(form._token) }}

                <!-- Buttons -->
                <div class="flex gap-4 justify-center pt-6 border-t border-gray-200">
                    <a href="{{ path('admin_users_index') }}"
                        style="padding: 12px 24px; border-radius: 12px; font-weight: 600; color: #4B164C; border: 1px solid #EFCFB4; background-color: white; transition: all 0.3s ease;" 
                        onmouseover="this.style.backgroundColor='#f0f0f0'" 
                        onmouseout="this.style.backgroundColor='white'">
                        ‚úï Cancel
                    </a>
                    <button type="submit" 
                        style="padding: 12px 32px; border-radius: 12px; font-weight: 600; color: white; background-color: #7F1734; border: none; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); transition: all 0.3s ease; cursor: pointer;" 
                        onmouseover="this.style.backgroundColor='#5E0B15'" 
                        onmouseout="this.style.backgroundColor='#7F1734'">
                        ‚úì Create User
                    </button>
                </div>

                {{ form_end(form, {'render_rest': false}) }}
            </div>
        </div>
    </div>
</div>

{% endblock %}
